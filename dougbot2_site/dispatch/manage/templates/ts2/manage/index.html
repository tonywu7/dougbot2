{% extends 'ts2/web/base.html' %}
{% load inspect elements builtins %}

{% block title %}Home - {{ discord.info.name|default:'server' }}{% endblock %}

{% block main_title %}
<span class="server-name">{{ discord.info.name|default:BRANDING_FULL }}</span>
{% endblock %}

{% block sections %}

{% if not discord.joined or discord.server.disabled %}
{% section id='server-access' title='access' %}
<form action="{% url 'web:join' %}" method="POST">
    <input type="hidden" name="guild_id" id="guild-id" value="{{ discord.server_id }}">
    {% csrf_token %}
    <button class="btn btn-info" type="submit">Join server</button>
</form>
{% endsection %}
{% endif %}

{% if discord.server %}
{% with server=discord.server %}

{% section id='general' title='general' %}
<div class="key-value-pair kvp-justify interactive-text">
    <span>command prefix</span><span class="text-info"><code>{{ server.prefix }}</code></span>
    <span>server name</span><span class="text-info">{{ discord.info.name }}</span>
    <span>server id</span><span class="text-info"><code>{{ server.snowflake }}</code></span>
</div>
{% endsection %}

{% section id='modules' title='modules' %}
<div class="key-value-pair kvp-justify interactive-text">
    {% for ext_label, ext_state in discord.extensions.items %}
    {% with ext_name=ext_state|item:1|attr:'title' ext_icon=ext_state|item:1|attr:'icon'|safe ext_state=ext_state|item:0 %}
    <span>{{ ext_icon }} {{ ext_name }}</span><span
        class="{{ ext_state|yesno:'text-on,text-off' }}">{{ ext_state|yesno:'Enabled,Disabled' }}</span>
    {% endwith %}
    {% empty %}
    <span>(No extensions found. Hmmmm...)</span>
    {% endfor %}
</div>
{% endsection %}

{% endwith %}
{% endif %}
{% endblock %}