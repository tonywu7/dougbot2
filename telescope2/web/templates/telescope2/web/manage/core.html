{% extends 'telescope2/web/manage/base.html' %}
{% load inspect element async_form %}

{% block main_title %}Core settings{% endblock %}

{% block sections %}

{% section id='global' title='global' %}

{% asyncform discord.forms.prefix id='global-settings' %}
<ul class="form-fields">{{ discord.forms.prefix.as_ul }}</ul>
{% csrf_token %}
<p>Example command: <code><span class="data-command-prefix"></span>echo</code></p>
{% asyncsubmit 'Save' 'primary' %}
{% endform %}

{% endsection %}

{% section id='extensions' title='modules' classes='grid-span-2' %}

{% asyncform discord.forms.extensions id='extension-toggles' %}
{% with discord.forms.extensions as form %}
<div class="form-fields key-value-pair kvp-left form-switch-theme-red-green">
    {% for input in form %}
    {% bs5switch input %}
    {% endfor %}
</div>
{% endwith %}
{% csrf_token %}
{% asyncsubmit 'Update settings' 'primary' %}
{% endform %}

{% endsection %}

{% if user_superuser or access_control %}

{% section id='server-access' title='access control' %}

<div class="form">
    <a href="{% url 'web:reset' guild_id=discord.current.id %}" class="btn btn-outline-danger">Reset
        server settings</a>
    <a href="{% url 'web:leave' guild_id=discord.current.id %}" class="btn btn-outline-danger">Leave
        server</a>
</div>

{% endsection %}

{% endif %}

{% if user_superuser or access_control %}
{% section id='server-debug' title='debug' %}

<form class="form" method="POST" action="{% url 'web:manage.sync' guild_id=discord.current.id %}">
    <ul class="form-fields">{{ discord.forms.sync_models.as_ul }}</ul>
    {% csrf_token %}
    <button type="submit" class="btn btn-outline-warning btn-submit">Synchronize models</button>
</form>

{% endsection %}
{% endif %}

{% endblock %}